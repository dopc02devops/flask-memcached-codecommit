

# e2 small
gcloud container clusters create my-cluster \
--num-nodes=2 \
--region europe-west2-a \
--release-channel "stable" \
--disk-type=pd-standard \
--machine-type "e2-small" \
--enable-ip-alias
# e2-medium
gcloud container clusters create my-cluster \
--num-nodes=3 \
--region europe-west2-a \
--release-channel "stable" \
--disk-type=pd-standard \
--machine-type "e2-medium" \
--enable-ip-alias
# e2-standard-2
gcloud container clusters create my-cluster \
--num-nodes=3 \
--region europe-west2-a \
--release-channel "stable" \
--disk-type=pd-standard \
--machine-type "e2-standard-2" \
--enable-ip-alias
# costs
Machine Type	vCPUs	Memory	Hourly Cost (USD)	Monthly Cost (USD)
e2-small	     2	    2 GB	    $0.016	                $12.23
e2-medium	     2	    4 GB	    $0.033	                $24.46
e2-standard-2	 2	    8 GB	    $0.067	                $48.92

# list firewalls
- gcloud compute firewall-rules list

# get machines
- gcloud compute instances list --zones europe-west2-a

# get machine tags
- gcloud compute instances describe <node-name> --format="get(tags.items)"

# tag machine
gcloud compute instances add-tags <node-name> --tags gke-my-cluster

# open firewall
gcloud compute firewall-rules create allow-ssh-and-custom-ports \
--allow tcp:22,tcp:8096,tcp:8091,tcp:8095 \
--target-tags gke-my-cluster \
--description "Allow SSH and custom ports access to GKE nodes" \
--direction INGRESS \
--priority 1000

# get credentials
gcloud container clusters get-credentials my-cluster --region europe-west2-a

# describe machine
gcloud compute instances describe my-vm --zone europe-west2-a --project superb-gear-443409-t3

# login to cluster
- go to cluster and copy connect command
- gcloud container clusters get-credentials my-cluster --zone europe-west2-a --project superb-gear-443409-t3

# Trigger cirleci pipeline
        git tag release-1.0
        git push origin release-1.0
        git commit --allow-empty -m "Trigger build"

        git tag v1.0.0
        git push origin v1.0.0


# commands for debugging
        kubectl get pods -n stage
        kubectl get pod <pod-name> -n stage
        kubectl logs <pod-name> -n stage
        kubectl get pvc -n stage
        kubectl describe pod <pod-name> -n stage
        kubectl get events -n stage
        kubectl describe deployment flask-app-deployment -n stage
        kubectl get pods --all-namespaces
        kubectl delete pods -l app=flask-app -n stage
        kubectl delete deployment flask-app-deployment -n stage
        kubectl delete service flask-app-service -n stage
        kubectl delete pvc flask-app-volume -n stage
        kubectl delete pvc flask-app-volume --force --grace-period=067 -n stage

# git commands
      git checkout -b ur-branch
      git checkout ur-branch
      git commit --allow-empty -m "Trigger build"
      git push origin ur-branch
      git commit --no-verify -m "added commands.txt file"
      git commit -q -m "Your commit message"
      git commit -m "Update docs [ci skip]"
      git push -q origin main
      git push origin main --no-verify

# Copy ssh keys
     pbcopy < ~/.ssh/id_kube_user_key.pub
     pbcopy < ~/.ssh/id_kube_user_key

# kill ports
sudo lsof -i :11211
sudo kill <PID>

# switch user root
sudo -i
sudo usermod -aG docker <your-username>
sudo usermod -aG sudo <your-username>
id jenkins